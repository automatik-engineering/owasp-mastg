const UITextAutocorrectionType = {
    0: ".default",
    1: ".no",
    2: ".yes"
};

var classes = ["UITextField", "UITextView", "UISearchBar"]

classes.forEach(inputClass => {
  hook(inputClass)
});

function hook(inputClass){
  Interceptor.attach(ObjC.classes.UITextField["- resignFirstResponder"].implementation, {
    onEnter(args) {
      const self = new ObjC.Object(args[0]);
      const correctionType =  UITextAutocorrectionType[self.autocorrectionType()]
      let cacheable = "Eligible for caching"
      const isSecure = self.isSecureTextEntry && self.isSecureTextEntry();
      if(correctionType == '.no' || isSecure){
        cacheable = "Excluded from caching"
      }
      console.log(`${cacheable} [autocorrectionType=${correctionType}, secure=${isSecure}, class=${self.$className}]: "${self.text()}"`);
    }
  });
}

